# *Исследовательский проект «Определение наличия психических расстройств по данным ФПГ»*

Этот репозиторий содержит реализацию программного продукта на языке Python с использованием машинного обучения и нейронных сетей, созданного и предназначенного для выявления и оценки риска наличия различных психических расстройств, на основе данных из его фотоплетизмограммы (ФПГ).


- С кодом для снятия собственных "кустарных" данных (которые мы объединяем с открытыми данными из исследований), а также методикой их получения, можно ознакомиться в этом репозитории: <br>**https://github.com/zhabiki/PPG-Dataset-DIY**

- Ознакомиться же с самими исследованиями по теме (в том числе с открытыми и/или используемыми нами данными) и выводами из них, а также рассмотренными ранее датасетами, можно здесь: <br>**https://docs.google.com/document/d/1nuOdxSKehN-uu5WzF-iZv0fn3jvBSY7twHKKJxZaAmY**


## Структура:

- `dataproc/`
    - `examples/` — Директория с примерами данных ФПГ здоровых людей в спокойном состоянии.
    - `filtering.py` — Вспомогательный класс фильтратора для данных, используемый препроцессором, содержащий методы для выполнения преобразований на основе Фурье и вейвлетов.
    - `preprocess.py` — Класс препроцессора для данных, проходящийся окном по (желательно предварительно отфильтрованным) сигналу ФПГ и извлекающий из них параметры вариабельности сердечного ритма (ВСР), LF/HF и их соотношение, RSA, и средние расстояния шагов сердечного цикла.
    - `preprocess_simple.py` — Более простой препроцессор, извлекающий только ЧСС и SDNN и выполняющий лишь базовую фильтрацию.
- `models/`
    - `data/` — Директория для хранения обработанных данных для тренировки и теста моделей.
    - `saves/` — Директория для хранения получившихся после тренировки моделей весов.
    - `inference.py` — Класс для загрузки весов указанной модели и выполнения ею предсказания на переданных данных, с возвратом результата предсказания.
    - `model.py` — Архитектура базовой модели, а также код для её тренировки на переданных данных для обучения, с возможностью сохранения получившихся весов по окончании.
- `__main.py__` — Точка входа для запуска продукта.
- `README.MD` — *(вы находитесь здесь)*
- `requirements.txt` — Список всех требуемых зависимостей для работы компонентов продукта.


## Запуск:

**[ WIP — Здесь будет описание, как запускать и использовать наш программный продукт ]**


## Обучение:

**[ WIP — Здесь будет расписано, как работать со скриптом для обучения новых моделей ]**


# *Каким образом работает наш код?*

Жизненный цикл данных можно представить примерно так:

![Диаграмма жизненного цикла данных ФПГ в момент обработки инференса](README-DIAG.svg)

1. На вход попадают необработанные данные ФПГ, выполняется их обработка и последующее извлечение параметров (ВСР, соотношение LF/HF, RSA и другие).

2. Затем, на основе предобученных на предварительно записанных данных моделей, по полученным из данных ФПГ параметрам выполняется оценка вероятности наличия тех или иных психических расстройств (каждая отдельная модель отвечает за одно конкретное психическое расстройство).

3. После этого, все полученные вероятности объединяются в общий итоговый словарь (список пар формата `название_расстройства: вероятность`), который и отправляется на выход.
